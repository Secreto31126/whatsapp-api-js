{
  "version": 3,
  "sources": ["../../src/middleware/vercel.ts"],
  "sourcesContent": ["import { WhatsAppAPI as NodeHTTPMiddleware } from \"./node-http.js\";\nimport { WhatsAppAPIError } from \"../errors.js\";\n\nimport type { VercelRequest } from \"@vercel/node\";\nimport type { GetParams } from \"../types.js\";\n\n/**\n * Vercel serverless functions middleware for WhatsAppAPI (Node/Next.js)\n */\nexport class WhatsAppAPI extends NodeHTTPMiddleware {\n    /**\n     * POST request handler for Vercel serverless functions\n     *\n     * @remarks This method expects the request body to be the original string, not a parsed body\n     * @see https://vercel.com/guides/how-do-i-get-the-raw-body-of-a-serverless-function\n     *\n     * @example\n     * ```ts\n     * import type { VercelRequest, VercelResponse } from \"@vercel/node\";\n     * import { WhatsAppAPI } from \"whatsapp-api-js/middleware/vercel\";\n     *\n     * const Whatsapp = new WhatsAppAPI({\n     *     token: \"YOUR_TOKEN\",\n     *     appSecret: \"YOUR_APP_SECRET\",\n     *     webhookVerifyToken: \"YOUR_WEBHOOK_VERIFY_TOKEN\"\n     * });\n     *\n     * // The `bodyParser: false` is required for the middleware to work\n     * export const config = {\n     *     api: {\n     *        bodyParser: false\n     *     }\n     * };\n     *\n     * export default async (req: VercelRequest, res: VercelResponse) => {\n     *     if (req.method === \"POST\") {\n     *         res.status(await Whatsapp.handle_post(req));\n     *         res.end();\n     *     }\n     * };\n     * ```\n     *\n     * @param req - The request object\n     * @returns The status code to be sent to the client\n     */\n    handle_post(req: VercelRequest): Promise<number> {\n        return super.handle_post(req);\n    }\n\n    /**\n     * GET request handler for Vercel serverless functions\n     *\n     * @example\n     * ```ts\n     * import type { VercelRequest, VercelResponse } from \"@vercel/node\";\n     * import { WhatsAppAPI } from \"whatsapp-api-js/middleware/vercel\";\n     *\n     * const Whatsapp = new WhatsAppAPI({\n     *     token: \"YOUR_TOKEN\",\n     *     appSecret: \"YOUR_APP_SECRET\",\n     *     webhookVerifyToken: \"YOUR_WEBHOOK_VERIFY_TOKEN\"\n     * });\n     *\n     * export default (req: VercelRequest, res: VercelResponse) => {\n     *     if (req.method === \"GET\") {\n     *         try {\n     *             res.end(Whatsapp.handle_get(req));\n     *             res.status(200);\n     *         } catch (e) {\n     *             res.status(e as number).end();\n     *         }\n     *     }\n     * };\n     * ```\n     *\n     * @override\n     * @param req - The request object\n     * @returns The challenge string to be sent to the client\n     * @throws The error code\n     */\n    handle_get(req: VercelRequest): string {\n        try {\n            return this.get(req.query as GetParams);\n        } catch (e) {\n            // In case who knows what fails \u00AF\\_(\u30C4)_/\u00AF\n            throw e instanceof WhatsAppAPIError ? e.httpStatus : 500;\n        }\n    }\n}\n"],
  "mappings": "AAAA,SAAS,eAAe,0BAA0B;AAClD,SAAS,wBAAwB;AAQ1B,MAAM,oBAAoB,mBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoChD,YAAY,KAAqC;AAC7C,WAAO,MAAM,YAAY,GAAG;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiCA,WAAW,KAA4B;AACnC,QAAI;AACA,aAAO,KAAK,IAAI,IAAI,KAAkB;AAAA,IAC1C,SAAS,GAAG;AAER,YAAM,aAAa,mBAAmB,EAAE,aAAa;AAAA,IACzD;AAAA,EACJ;AACJ;",
  "names": []
}
