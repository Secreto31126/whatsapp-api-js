{
  "version": 3,
  "sources": ["../../../src/middleware/adonis.ts"],
  "sourcesContent": ["import { WhatsAppAPIMiddleware } from \"./globals.js\";\nimport { isInteger } from \"../utils.js\";\n\nimport type { Request } from \"@adonisjs/http-server/build\";\nimport type { GetParams, PostData } from \"../types\";\n\n/**\n * AdonisJS middleware for WhatsAppAPI\n */\nexport class WhatsAppAPI extends WhatsAppAPIMiddleware {\n    /**\n     * POST request handler for AdonisJS\n     *\n     * @example\n     * ```ts\n     * import Route from \"@ioc:Adonis/Core/Route\";\n     * import { WhatsAppAPI } from \"whatsapp-api-js/middleware/adonis\";\n     *\n     * const Whatsapp = new WhatsAppAPI({\n     *     token: \"YOUR_TOKEN\",\n     *     appSecret: \"YOUR_APP_SECRET\",\n     *     webhookVerifyToken: \"YOUR_WEBHOOK_VERIFY_TOKEN\"\n     * });\n     *\n     * Route.post('/', async ({ request, response }) => {\n     *     response.status(await Whatsapp.handle_post(request));\n     * });\n     * ```\n     *\n     * @override\n     * @param req - The request object from AdonisJS\n     * @returns The status code to be sent to the client\n     */\n    async handle_post(req: Request) {\n        try {\n            return await this.post(\n                req.body() as PostData,\n                req.raw() ?? \"\",\n                req.header(\"x-hub-signature-256\") ?? \"\"\n            );\n        } catch (e) {\n            // In case who knows what fails \u00AF\\_(\u30C4)_/\u00AF\n            return isInteger(e) ? e : 500;\n        }\n    }\n\n    /**\n     * GET request handler for AdonisJS\n     *\n     * @example\n     * ```ts\n     * import Route from \"@ioc:Adonis/Core/Route\";\n     * import { WhatsAppAPI } from \"whatsapp-api-js/middleware/adonis\";\n     *\n     * const Whatsapp = new WhatsAppAPI({\n     *     token: \"YOUR_TOKEN\",\n     *     appSecret: \"YOUR_APP_SECRET\",\n     *     webhookVerifyToken: \"YOUR_WEBHOOK_VERIFY_TOKEN\"\n     * });\n     *\n     * Route.get('/', ({ request, response }) => {\n     *     try {\n     *         return Whatsapp.handle_get(request);\n     *     } catch (e) {\n     *         response.status(e as number);\n     *     }\n     * });\n     * ```\n     *\n     * @override\n     * @param req - The request object from AdonisJS\n     * @returns The challenge string to be sent to the client\n     * @throws The error code\n     */\n    handle_get(req: Request) {\n        try {\n            return this.get(req.qs() as GetParams);\n        } catch (e) {\n            // In case who knows what fails \u00AF\\_(\u30C4)_/\u00AF\n            throw isInteger(e) ? e : 500;\n        }\n    }\n}\n"],
  "mappings": "AAAA,OAAS,0BAA6B,eACtC,OAAS,cAAiB,cAQnB,MAAM,oBAAoB,qBAAsB,CAwBnD,MAAM,YAAY,IAAc,CAC5B,GAAI,CACA,OAAO,MAAM,KAAK,KACd,IAAI,KAAK,EACT,IAAI,IAAI,GAAK,GACb,IAAI,OAAO,qBAAqB,GAAK,EACzC,CACJ,OAAS,EAAG,CAER,OAAO,UAAU,CAAC,EAAI,EAAI,GAC9B,CACJ,CA8BA,WAAW,IAAc,CACrB,GAAI,CACA,OAAO,KAAK,IAAI,IAAI,GAAG,CAAc,CACzC,OAAS,EAAG,CAER,MAAM,UAAU,CAAC,EAAI,EAAI,GAC7B,CACJ,CACJ",
  "names": []
}
